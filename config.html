<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ API - Web –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-left">
            <img src="images/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo">
        </div>
        <div class="navbar-right">
            <button id="theme-toggle" class="theme-toggle">üåô –¢–µ–º–Ω–∞—è</button>
        </div>
    </nav>

    <!-- Configuration Form -->
    <div class="auth-container">
        <div class="auth-card">
            <h1>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h1>
            <p>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É API</p>

            <form id="config-form">
                <div class="form-group">
                    <label for="api-host">–•–æ—Å—Ç API</label>
                    <input type="text" id="api-host" name="api-host" required placeholder="example.com">
                    <small>–£–∫–∞–∂–∏—Ç–µ —Ö–æ—Å—Ç –±–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: example.com)</small>
                </div>

                <div class="form-group">
                    <label for="api-db">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</label>
                    <input type="text" id="api-db" name="api-db" required placeholder="mydb">
                    <small>–ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è</small>
                </div>

                <div class="form-group">
                    <label>
                        <input type="checkbox" id="use-localstorage">
                        –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∂–∏–º localStorage (–±–µ–∑ API)
                    </label>
                    <small>–í–∫–ª—é—á–∏—Ç–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –±–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É</small>
                </div>

                <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>

                <div class="auth-links">
                    <a href="login.html">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—Ö–æ–¥—É</a>
                </div>
            </form>

            <div id="current-config" class="config-status" style="margin-top: 20px;">
                <h3>–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:</h3>
                <p><strong>–•–æ—Å—Ç:</strong> <span id="current-host">–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω</span></p>
                <p><strong>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:</strong> <span id="current-db">–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞</span></p>
                <p><strong>–†–µ–∂–∏–º:</strong> <span id="current-mode">localStorage</span></p>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const configForm = document.getElementById('config-form');
            const apiHostInput = document.getElementById('api-host');
            const apiDbInput = document.getElementById('api-db');
            const useLocalStorageCheckbox = document.getElementById('use-localstorage');

            // Load current configuration
            const currentConfig = apiConfig.getConfig();
            if (currentConfig.host) {
                apiHostInput.value = currentConfig.host;
                document.getElementById('current-host').textContent = currentConfig.host;
            }
            if (currentConfig.db) {
                apiDbInput.value = currentConfig.db;
                document.getElementById('current-db').textContent = currentConfig.db;
            }

            // Set mode display
            const isConfigured = apiConfig.isConfigured();
            document.getElementById('current-mode').textContent = isConfigured ? 'API' : 'localStorage';
            useLocalStorageCheckbox.checked = !isConfigured;

            // Handle localStorage checkbox
            useLocalStorageCheckbox.addEventListener('change', (e) => {
                if (e.target.checked) {
                    apiHostInput.disabled = true;
                    apiDbInput.disabled = true;
                } else {
                    apiHostInput.disabled = false;
                    apiDbInput.disabled = false;
                }
            });

            // Handle form submission
            configForm.addEventListener('submit', (e) => {
                e.preventDefault();

                if (useLocalStorageCheckbox.checked) {
                    // Clear API configuration
                    apiConfig.setConfig('', '');
                    alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ä–µ–∂–∏–º–µ localStorage.');
                } else {
                    const host = apiHostInput.value.trim();
                    const db = apiDbInput.value.trim();

                    if (!host || !db) {
                        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                        return;
                    }

                    apiConfig.setConfig(host, db);
                    alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ API —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!');
                }

                // Reload to apply new settings
                window.location.reload();
            });
        });
    </script>
</body>
</html>
